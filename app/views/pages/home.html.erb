<%#
  Home Page View
  Main landing page for the LeagueBox application.
  Displays welcome information, feature overview, getting started guide, and navigation links.
  Uses Stimulus toggle controller for collapsible sections and scroll-to-top functionality.
  Different content is shown for authenticated vs. non-authenticated users.
%>

<%# Hero Image: Hidden on mobile, visible on desktop and larger screens %>
<div class="d-none d-md-block"><%= render "shared/image_front" %></div>

<%# Main Container: Responsive padding and Stimulus toggle controller %>
<div class="container-fluid px-2 px-md-3 px-lg-4"
     data-controller="toggle" >
  <%# Main Content Area: Styled frame with scrollable content %>
  <div class="photo-home-text frame-color-shape frame-padding frame-margin-rl text-size box-scroller"
        data-toggle-target="togglableElement">
    <!-- Main Title Section -->
    <header class="home-header mb-4 mb-md-5">
      <h1 class="title mb-0">
        <b><%= t(".main_title").upcase %></b>
      </h1>
    </header>

    <!-- Welcome Section: Introduction to LeagueBox -->
    <%= render "pages/home_section", section_number: 1, icon: "ğŸ†", title_key: ".welcome_title" do %>
      <p><%= t '.p01_html' %></p>
      <p><%= t '.p02_html' %></p>
      <p><%= t '.p03_html' %></p>
    <% end %>

    <!-- LeagueBox at a Glance Section: Feature overview with conditional links -->
    <%= render "pages/home_section", section_number: 2, icon: "ğŸ§‘â€ğŸ’»", title_key: ".use_title" do %>
      <ol class="home-features-list">
        <%# Determine class prefix based on authentication status %>
        <% class_prefix = current_user ? "btn btn-inlayed bold-font color-" : "bold-font color-" %>
        <% if current_user %>
          <%# Authenticated users: Display clickable links to actual pages %>
          <li class="home-feature-item"><%= t(".li06_html", inset: "<a class='#{class_prefix}green' href='#{@path["02"]}'>#{t ".li06_boxes"}</a>".html_safe) %></li>
          <li class="home-feature-item"><%= t(".li07_html", inset_a: "<a class='#{class_prefix}tennis-blue' href='#{@path["03a"]}'>#{t ".li07_list_view"}</a>".html_safe,
                                             inset_b: "<a class='#{class_prefix}tennis-blue' href='#{@path["03b"]}'>#{t ".li07_grid_view"}</a>".html_safe,
                                             inset_c: "<a class='#{class_prefix}tennis-red' href='#{@path["01"]}'>#{t ".li07_my_scores"}</a>".html_safe) %></li>
          <li class="home-feature-item"><%= t(".li08_html", inset_a: "<a class='#{class_prefix}green' href='#{@path["04a"]}'>#{t ".li08_round_ranking"}</a>".html_safe,
                                             inset_b: "<a class='#{class_prefix}green' href='#{@path["04b"]}'>#{t ".li08_league_table"}</a>".html_safe) %></li>
        <% else %>
          <%# Non-authenticated users: Display styled spans (no links) %>
          <li class="home-feature-item"><%= t(".li06_html", inset: "<span class='#{class_prefix}green'>#{t ".li06_boxes"}</span>".html_safe) %></li>
          <li class="home-feature-item"><%= t(".li07_html", inset_a: "<span class='#{class_prefix}tennis-blue'>#{t ".li07_list_view"}</span>".html_safe,
                                             inset_b: "<span class='#{class_prefix}tennis-blue'>#{t ".li07_grid_view"}</span>".html_safe,
                                             inset_c: "<span class='#{class_prefix}tennis-red'>#{t ".li07_my_scores"}</span>".html_safe) %></li>
          <li class="home-feature-item"><%= t(".li08_html", inset_a: "<span class='#{class_prefix}green'>#{t ".li08_round_ranking"}</span>".html_safe,
                                             inset_b: "<span class='#{class_prefix}green'>#{t ".li08_league_table"}</span>".html_safe) %></li>
        <% end %>
      </ol>
    <% end %>

    <!-- Ready Section: Getting started guide with numbered steps -->
    <% racket_icon = render("shared/racket_icon", mobile_width: 20, desktop_width: 30, mobile_class: "section-icon d-inline d-md-none", desktop_class: "section-icon d-none d-md-inline") %>
    <%= render "pages/home_section", section_number: 3, icon: racket_icon, title_key: ".ready_title" do %>
      <p><%= t '.p04' %></p>
      <%# Step list: Dynamically renders translation keys li09_html through li12_html %>
      <ol id="steps" class="home-steps-list">
        <% (9..12).each do |i| %>
          <li class="home-step-item"><%= t ".li#{format('%02d', i)}_html" %></li>
        <% end %>
      </ol>
    <% end %>

    <!-- Call to Action: Primary navigation button (login or view boxes) -->
    <div class="home-cta-section my-4 my-md-5">
      <div class="buttons-wrap d-flex flex-row gap-2 justify-content-center align-items-center flex-wrap">
        <%# Show "View Boxes" button for authenticated users, "Login" for non-authenticated %>
        <% if user_signed_in? %>
          <%= link_to t("pages.common.ok_view_boxes"), boxes_path, class: "btn btn-shape btn-aqua text-size w-100 w-sm-auto" %>
          <%# Show admin/referee buttons on mobile %>
          <% if @is_mobile %>
            <%= render "shared/admin_referee_buttons" %>
          <% end %>
        <% else %>
          <%= link_to t('.login_link'), new_user_session_path, class: "btn btn-shape btn-aqua text-size w-100 w-sm-auto" %>
        <% end %>
      </div>
    </div>

    <!-- Social Tennis Image: Decorative image section -->
    <div class="home-image-section mb-4" data-toggle-target="image">
      <%= image_tag "social_tennis.jpg", alt: "Social tennis", class: "img-fluid rounded", width: "100%" %>
    </div>

    <!-- Rules Section: Link to rules page and tournament message -->
    <section class="home-rules-section text-center my-4 my-md-5">
      <%# CSS class prefix for styled links %>
      <% class_prefix = "btn btn-inlayed bold-font color-" %>
      <%# Racket icon: Responsive sizing (small on mobile, larger on desktop) %>
      <div class="title mb-3">
        <%= render "shared/racket_icon", mobile_width: 25, desktop_width: 50 %>
      </div>
      <%# Rules link paragraph %>
      <div class="title">
        <p class="mb-3"><%= t(".p05_html", inset: "<a class='#{class_prefix}black' href='#{@path["05"]}'>#{t ".li13"}</a>".html_safe) %></p>
      </div>
      <%# Tournament message %>
      <div class="title">
        <h5 class="mb-0"><b><%= t '.happy_tournament' %></b></h5>
      </div>
    </section>

    <!-- Club Join Section: Information about joining a club -->
    <section class="home-join-section my-4 my-md-5">
      <h5 class="color-tennis-blue mb-3"><b>ğŸ‘¤ <%= t '.club_join_title' %></b></h5>
      <%# Contact link paragraph with styled link %>
      <p class="mb-4"><%= t(".p06_html", inset: "<a class='#{class_prefix}tennis-blue' href='#{@path["06"]}'>#{t ".li14"}</a>".html_safe) %></p>
      <%# Decorative racket icons: Responsive sizing %>
      <div class="buttons-wrap text-center">
        <%= render "shared/racket_icon", mobile_width: 25, desktop_width: 50 %>
      </div>
    </section>

    <!-- Scroll to Top Button: Floating button (hidden by default, shown via Stimulus) -->
    <button data-action="click->toggle#scrollToTop" data-toggle-target="topButton"
      class="btn btn-shape btn-beige top-button d-none">
      <i class="fa-solid fa-up-long"></i>
    </button>
  </div>

  <!-- Bottom Navigation: Conditional navigation links based on user role -->
  <div class="home-bottom-nav mt-4">
    <div class="buttons-wrap d-flex flex-row gap-2 justify-content-center align-items-center flex-wrap">
      <%# Show admin/referee buttons on desktop (hidden on mobile, shown in CTA section) %>
      <% unless @is_mobile %>
        <%= render "shared/admin_referee_buttons" %>
      <% end %>
    </div>
  </div>
</div>
